<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Carta de servicios · Ikigai Centro de Masajes</title>

<!-- Favicons -->
<link rel="icon" href="./favicon.ico" sizes="any">
<link rel="icon" href="./favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="./apple-touch-icon.png">

<!-- <link rel="manifest" href="./site.webmanifest">
<meta name="theme-color" content="#776B5D">  -->

    
<meta content="Carta de servicios · Ikigai Centro de Masajes" name="description"/>
<!-- Fonts -->
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Playfair:opsz,wght@5..120,300..900&amp;family=Playfair+Display:ital,wght@0,400..900;1,400..900&amp;family=Poppins:wght@300;400;500;600&amp;display=swap" rel="stylesheet"/>
<style>
    :root{
      /* Brand colors */
      --nogal:#776B5D;
      --albura:#EBE3D5;
      --veta:#1F1F1F;

      /* Derived palette */
      --paper: var(--albura);
      --ink: var(--veta);
      --muted: rgba(31,31,31,.64);
      --muted-2: rgba(31,31,31,.50);
      --line: rgba(31,31,31,.18);
      --line-strong: rgba(31,31,31,.30);
      --wash: rgba(31,31,31,.04);

      --serif:"Playfair", Georgia, "Times New Roman", serif;
      --serif-display:"Playfair Display", Georgia, "Times New Roman", serif;
      --sans:"Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;

      --max:1120px;
      --px: clamp(16px, 3vw, 28px);

      /* Logo */
      --logo-h: clamp(66px, 7.2vw, 110px);

      /* Unified radius (same as service cards) */
      --radius: 8px;

      

      /* Buttons */
      --btn-h: 48px;
      --btn-px: 16px;
/* spacing */
      --gap: 18px;
      --page-top: 22px;

      /* No bottom sticky footer CTA (reservas via modal in header) */
      --cta-h: 0px;
    }

    *{box-sizing:border-box}
    html, body { height: 100%; }
    body{
      margin:0;
      background:var(--paper);
      color:var(--ink);
      font-family:var(--sans);
      text-rendering:optimizeLegibility;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    a{color:inherit}
    .wrap{ max-width:var(--max); margin:0 auto; padding:0 var(--px); }

    /* TOP STICKY: LOGO + TABS */
    .top-sticky{
      position:sticky;
      top:0;
      z-index:40;
      background: rgba(235,227,213,.92);
      backdrop-filter: blur(10px);
      border-bottom:none;
}
    .site-header{ border-bottom:1px solid var(--line); }

    .header-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      padding:18px 0;
      min-height: calc(var(--logo-h) + 12px);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:14px;
      min-width: 240px;
    }

    .brand-logo-link{
      display: flex;
      align-items: center;
      gap: 14px;
      text-decoration: none;
      color: inherit;
    }

    .brand-logo{
      display:block;
      height: var(--logo-h);
      width:auto;
      max-width: 360px;
      filter: none;
    }

    .brand-fallback{
      display:none;
      flex-direction:column;
      line-height:1;
    }
    .brand-fallback .word{
      font-family:var(--serif);
      font-weight:600;
      font-size:28px;
      letter-spacing:.2px;
    }
    .brand-fallback .sub{
      font-size:10px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--muted);
      margin-top:6px;
    }

    /* Tabs */
    .tabs-bar{
      border-top:none;
      border-bottom:1px solid var(--line);
      background: rgba(235,227,213,.76);
    
    
    }
    .tabs-inner{
      display:flex;
      gap:10px;
      align-items:center;
      padding:12px 0;
      /* Horizontal scroll for reduced screens */
      overflow-x:auto;
      overflow-y:hidden;
      -webkit-overflow-scrolling:touch;
      scrollbar-width:none; /* Firefox */
      scroll-snap-type:x mandatory;
    }
    .tabs-inner::-webkit-scrollbar{ display:none; }
     .tab{
      appearance:none;
      border:1px solid var(--line);
      background: rgba(31,31,31,.04);
      color:var(--nogal);
      border-radius: var(--radius);
      padding:10px 12px;
      font-family:var(--sans);
      font-size:14px;
      font-weight:400;
      cursor:pointer;
      line-height:1;
      white-space:nowrap;
      scroll-snap-align:start;
      transition: background .15s ease, border-color .15s ease;
    }

    /* Fade edges hint when scrolling tabs */
    .tabs-bar{
      position:relative;
    }
    .tabs-bar::before,
    .tabs-bar::after{
      content:"";
      position:absolute;
      top:0;
      bottom:0;
      width:24px;
      pointer-events:none;
      z-index:2;
    }
    .tabs-bar::before{
      left:0;
      background:linear-gradient(to right, rgba(235,227,213,1), rgba(235,227,213,0));
    }
    .tabs-bar::after{
      right:0;
      background:linear-gradient(to left, rgba(235,227,213,1), rgba(235,227,213,0));
    }
    .tab[aria-selected="true"]{
      background: rgba(31,31,31,.08);
      color:#776B5D;
      border-color: var(--nogal);
      font-family:var(--sans);
      font-size:14px;
      font-weight:500;
    }
    .tab:focus-visible{
      outline:4px solid rgba(31,31,31,.28);
      outline-offset:2px;
    }

    /* PAGE */
    main{
      padding: var(--page-top) 0 44px;
      padding-bottom: calc(44px + 86px);
    }

    /* Panels */
    .panel{ display:none; }
    .panel[aria-hidden="false"]{ display:block; }

    /* Grid */
    .grid-3{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap: var(--gap);
      align-items: start;
    }

    /* Cards */
    .card{
      border:1px solid rgba(31,31,31,.28);
      border-radius: var(--radius);
      background: rgba(255,255,255,.06);
      padding:22px 22px 18px;
      box-shadow: 0 0 0 1px rgba(31,31,31,.04) inset;
    }

    /* Featured card (Recomendado) */
    .card-featured{
      border:1px solid rgba(31,31,31,.28);
      box-shadow: none;
    }
    .card-flag{
      display:block;
      font-family:var(--serif);
      font-size:16px;
      color:var(--nogal);
      margin: 2px 0 10px;
    }

    /* Time bars (full width inside card) */
    .time-bar{
      display:grid;
      grid-template-columns:1fr 1fr;
      border-top:1px solid rgba(31,31,31,.28);
      border-bottom:1px solid rgba(31,31,31,.28);
      margin-top:16px;
    }
    .time-bar > div{
      text-align:center;
      padding:10px 0;
      font-family:var(--sans);
      font-size:14px;
      color: var(--ink);
    }
    .time-bar > div + div{
      border-left:1px solid rgba(31,31,31,.28);
    }
    .time-bar.single{
      grid-template-columns:1fr;
    }
    .time-bar.single > div{
      border-left:none;
    }
    .time-bar .price{
      font-family: var(--sans);
      font-weight: 600;
      font-size: 18px;
      color: var(--nogal);
      display: inline-block;
    }
    .time-bar .time-sep{
      margin: 0 10px;
      color: var(--muted);
      font-weight: 400;
      font-size: 14px;
    }
    .time-bar .duration{ font-size: 14px; color: var(--ink); }
    /* Precio abajo: barra al final de la card (rituales/bonos), Poppins semibold */
    .price-bar{
      border-top: 1px solid rgba(31,31,31,.28);
      margin-top: 16px;
      padding: 12px 0 0;
      text-align: center;
    }
    .price-bar .card-price{
      font-family: var(--sans);
      font-weight: 600;
      font-size: 22px;
      color: var(--nogal);
      letter-spacing: .02em;
      margin: 0;
    }
    /* Bonus info blocks (as rounded bars like reference) */
    .info-grid{
      margin-top:16px;
      display:grid;
      gap:12px;
    }
    .info-row{
      display:grid;
      gap:12px;
    }
    .info-row.two{
      grid-template-columns: auto minmax(0,1fr);
      align-items:stretch;
    }
    .info-cell{
      border:1px solid rgba(31,31,31,.28);
      border-radius: var(--radius);
      background: rgba(255,255,255,.04);
      padding:12px 16px;
      text-align:center;
      font-family:var(--sans);
      font-weight:400;
      font-size:16px; /* fixed for consistency */
      line-height:1.3;
      color: var(--nogal);
      min-width:0; /* allow wrapping inside grid */
      white-space:normal;
      overflow-wrap:anywhere;
      word-break:normal;
      hyphens:auto;
    }
    .info-cell.compact{
      font-weight:400;
    }

    @media (max-width: 820px){
      .reserve-grid{ grid-template-columns:1fr; }

      .info-row.two{ grid-template-columns: 1fr; }
    }

    @media (max-width: 560px){
      .info-cell{ padding:14px 12px; }
    }

/* Headings */

    .h3{
      font-family:var(--serif);
      font-weight:500;
      font-size:28px;
      line-height:1.08;
      margin:0 0 10px;
      color: var(--ink);
    }
    .h3.big{ font-size:28px; }

    .p{
      font-size:14px;
      line-height:1.75;
      margin:0 0 14px;
      max-width:62ch;
      color: var(--ink);
    }

    .meta{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-top:10px;
      color:var(--muted);
      font-size:13px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      padding:8px 10px;
      border-radius: var(--radius);
      border:1px solid var(--line);
      background: rgba(31,31,31,.03);
      font-size:14px;
      color: #1f1f1f;
      white-space:nowrap;
    }

    .choice{
      font-family:var(--serif);
      font-style:medium;
      color:#1f1f1f;
      font-size:14px;
    }

    /* Ritual includes */
    .includes{
      margin-top:12px;
      border-top:1px solid var(--line);
      padding-top:12px;
    }
    .includes-title{
      font-family:var(--serif);
      font-size:18px;
      letter-spacing:.02em;
      text-transform:none;
      color:var(--muted);
      margin-bottom:10px;
      font-weight:500;
    }
    .includes-row{
      font-family:var(--serif);
      display:flex;
      justify-content:space-between;
      gap:15px;
      padding:8px 0;
      border-bottom:1px solid var(--line);
      font-size:19px;
      line-height:1.2;
    }
    .includes-row:last-child{ border-bottom:none; }
    .includes-row strong{ font-weight:600; color:var(--ink); }
    .includes-time{ font-family:var(--sans); font-size:14px; color:var(--muted); white-space:nowrap; }

    /* Inline note next to "Masaje relajante" (same line) */
    .inline-note{
      font-family: var(--serif);
      font-style: italic;
      color: var(--muted-2);
      font-size: 13px;
      margin-left: 6px;
      white-space: nowrap;
    }

    /* BONO card */
    .bonus-title{
      font-family:var(--serif);
      font-weight:400;
      font-size:28px;
      margin:0 0 10px;
    }
    .divider{
      height:1px;
      background:var(--line);
      margin:18px 0;
    }
    .cond-title{
      font-family:var(--serif);
      font-style:italic;
      color:var(--ink);
      margin:0 0 10px;
    }
    .bullets{
      margin:0;
      padding-left:18px;
      color:var(--ink);
      font-size:14px;
      line-height:1.75;
    }

    /* Buttons */
    .cta-btn{
      font-family:var(--sans);
      font-size:14px;
      font-weight:500;

      /* Unified anatomy */
      height: var(--btn-h);
      min-height: var(--btn-h);
      padding: 0 var(--btn-px);
      line-height: 1;

      border-radius: var(--radius);
      border:1px solid var(--line-strong);
      text-decoration:none;
      color:var(--ink);
      background:transparent;

      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:100%;
      white-space:nowrap;
      cursor:pointer;
    }
    .cta-btn.primary{
      background: var(--nogal);
      color: var(--albura);
      border-color: var(--nogal);
    }

    /* Header reserve button */
    .reserve-btn{
      width:auto;
      height: var(--btn-h);
      min-height: var(--btn-h);
      padding: 0 14px;
      cursor:pointer;
    }
    .contact-btn{
      width:auto;
      height: var(--btn-h);
      min-height: var(--btn-h);
      padding: 0 14px;
      cursor:pointer;
      background: transparent;
    }
    @media (max-width:480px){
      .header-inner{ gap:10px; }
      .contact-btn{ padding: 0 12px; }
      .reserve-btn{ padding: 0 12px; }
    }

    /* Modal */
    .modal{
      position:fixed;
      inset:0;
      z-index:80;
      display:none;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .modal[aria-hidden="false"]{ display:flex; }
    .modal-backdrop{
      position:absolute;
      inset:0;
      background: rgba(31,31,31,.55);
      backdrop-filter: blur(6px);
    }
    .modal-card{
      position:relative;
      width:min(520px, 100%);
      max-height: calc(100vh - 48px);
      overflow:auto;
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.22);
      background: rgba(235,227,213,.98);
      box-shadow: 0 18px 50px rgba(0,0,0,.28);
      padding:20px;
      -webkit-overflow-scrolling: touch;
    }
    .modal-title{
      font-family: var(--serif);
      font-weight:600;
      font-size:28px;
      margin:0 0 10px;
    }
    .modal-body{
      margin:0 0 16px;
      color: var(--muted);
      font-size:14px;
      line-height:1.6;
    }
    .modal-actions{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      align-items:center;
    }
    .modal-close{
      appearance:none;
      border:0;
      background: transparent;
      position:absolute;
      top:10px;
      right:10px;
      width:36px;
      height:36px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      cursor:pointer;
    }
    .modal-close:hover{ background: rgba(31,31,31,.06); }
    .modal-close:focus-visible{
      outline:4px solid rgba(31,31,31,.28);
      outline-offset:2px;
    }
    .x{
      width:14px;
      height:14px;
      position:relative;
    }
    .x::before,
    .x::after{
      content:"";
      position:absolute;
      top:50%;
      left:0;
      right:0;
      height:2px;
      background: rgba(31,31,31,.65);
      transform-origin:center;
    }
    .x::before{ transform: translateY(-50%) rotate(45deg); }
    .x::after{ transform: translateY(-50%) rotate(-45deg); }


    /* Reserve form (service/day/time) */
    .reserve-form{ margin: 16px 0 18px; }
    .reserve-form > .rf,
    .reserve-form > .reserve-grid{
      display: block;
      margin-bottom: 18px;
    }
    .reserve-form > .reserve-grid:last-of-type,
    .reserve-form > *:last-child{ margin-bottom: 0; }
    .rf{
      display:block;
      margin: 0;
    }
    .rf > span{
      display:block;
      font-size: 13px;
      font-weight: 500;
      letter-spacing: .02em;
      color: var(--ink);
      margin-bottom: 8px;
    }
    .rf select,
    .rf input[type="text"]{
      width: 100%;
      min-height: 46px;
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background-color: rgba(255,255,255,.35);
      padding: 12px 14px;
      font-family: var(--sans);
      font-size: 15px;
      color: var(--ink);
      transition: border-color .2s ease, box-shadow .2s ease, background-color .2s ease;
    }
    .rf select:hover,
    .rf input:hover{
      border-color: var(--line-strong);
      background-color: rgba(255,255,255,.45);
    }
    .rf select:focus,
    .rf input:focus{
      outline: none;
      border-color: var(--nogal);
      box-shadow: 0 0 0 2px rgba(119,107,93,.18);
      background-color: rgba(255,255,255,.5);
    }
    .rf input::placeholder{
      color: var(--muted-2);
    }
    .rf select{
      cursor: pointer;
      appearance: none;
      background-color: rgba(255,255,255,.35);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%231F1F1F' fill-opacity='0.6' d='M2.5 4.5L6 8l3.5-3.5'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      padding-right: 40px;
    }
    .rf select:hover{ background-color: rgba(255,255,255,.45); }
    .rf select:focus{ background-color: rgba(255,255,255,.5); }

    /* Calendario personalizado Ikigai */
    .ikigai-date-wrap{ position: relative; }
    .ikigai-calendar{
      position: absolute;
      top: 100%;
      left: 0;
      margin-top: 8px;
      width: 300px;
      padding: 18px;
      background: var(--paper);
      border: 1px solid rgba(31,31,31,.28);
      border-radius: var(--radius);
      box-shadow: 0 0 0 1px rgba(31,31,31,.04) inset, 0 12px 40px rgba(0,0,0,.2);
      font-family: var(--sans);
      z-index: 100;
      display: none;
    }
    .ikigai-calendar.open{ display: block; }
    .ikigai-cal-head{
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding-bottom: 14px;
      margin-bottom: 14px;
      border-bottom: 1px solid var(--line);
    }
    .ikigai-cal-title{ font-weight: 600; font-size: 15px; color: var(--ink); letter-spacing: .02em; }
    .ikigai-cal-nav{ display: flex; gap: 8px; }
    .ikigai-cal-nav-btn{
      width: 34px; height: 34px;
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(31,31,31,.04);
      color: var(--nogal);
      cursor: pointer;
      display: grid; place-items: center;
      font-size: 16px; line-height: 1;
      transition: background .15s, border-color .15s;
    }
    .ikigai-cal-nav-btn:hover:not(:disabled){ background: rgba(31,31,31,.08); border-color: var(--nogal); }
    .ikigai-cal-nav-btn:disabled{ opacity: .4; cursor: not-allowed; color: var(--muted-2); }
    .ikigai-cal-weekdays{
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
      margin-bottom: 10px;
    }
    .ikigai-cal-weekday{
      text-align: center;
      font-size: 11px;
      font-weight: 500;
      color: var(--muted);
      letter-spacing: .03em;
    }
    .ikigai-cal-days{
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
    }
    .ikigai-cal-day{
      aspect-ratio: 1;
      max-width: 36px;
      max-height: 36px;
      display: grid;
      place-items: center;
      font-size: 14px;
      font-weight: 400;
      color: var(--ink);
      border-radius: var(--radius);
      cursor: pointer;
      border: 1px solid transparent;
      background: transparent;
      transition: background .15s, color .15s, border-color .15s;
    }
    .ikigai-cal-day:hover:not(.disabled):not(.past){ background: rgba(31,31,31,.04); color: var(--nogal); }
    .ikigai-cal-day.selected{ background: var(--nogal); color: var(--albura); border-color: var(--nogal); }
    .ikigai-cal-day.other{ color: var(--muted-2); visibility: hidden; }
    .ikigai-cal-day.disabled{ color: var(--muted-2); cursor: not-allowed; }
    .ikigai-cal-day.disabled:hover{ background: transparent; color: var(--muted-2); }
    .ikigai-cal-day.past{ color: var(--muted-2); cursor: not-allowed; }
    .ikigai-cal-day.past:hover{ background: transparent; color: var(--muted-2); }

    /* Field wrapper: input/select + clear button side-by-side (X OUTSIDE the field) */
.rf-control{
  display: flex;
  gap: 10px;
  align-items: stretch;
}
.rf-control > select,
.rf-control > input,
.rf-control > .ikigai-date-wrap{
  flex: 1 1 auto;
  min-width: 0;
}
.ikigai-date-wrap{ cursor: pointer; }
    .ikigai-date-wrap input{ width: 100%; cursor: pointer; }

.rf-clear{
  position: static;
  width: 46px;
  min-width: 46px;
  min-height: 46px;
  border-radius: var(--radius);
  border: 1px solid var(--line);
  background-color: rgba(255,255,255,.35);
  display: grid;
  place-items: center;
  cursor: pointer;
  padding: 0;
  align-self: stretch;
  transition: border-color .2s ease, background-color .2s ease, box-shadow .2s ease;
}
    .rf-clear:hover{
      border-color: var(--line-strong);
      background-color: rgba(255,255,255,.5);
    }
    .rf-clear:focus-visible{
      outline: none;
      border-color: var(--nogal);
      box-shadow: 0 0 0 2px rgba(119,107,93,.18);
    }
    .rf-clear .x::before,
    .rf-clear .x::after{ background: var(--nogal); }
    .rf-clear[hidden]{ display: none !important; }

    
/* Checkbox fieldset + clear button side-by-side */
.rf-control-fieldset{
  display:flex;
  gap:8px;
  align-items:stretch;
}
.rf-control-fieldset .rf-fieldset{
  flex:1 1 auto;
  min-width:0;
}
.rf-clear-fieldset{
  position:static;
  transform:none;
  align-self:stretch;
}

.rf select[multiple]{
      min-height: 132px;
      padding: 12px 14px;
    }

    /* Screen-reader only */
    .sr-only{
      position:absolute;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }

    /* Accessible checkbox multi-select (bono regalo) */
    .rf-fieldset{
      border: 1px solid rgba(31,31,31,.28);
      border-radius: var(--radius);
      background: rgba(255,255,255,.04);
      box-shadow: 0 0 0 1px rgba(31,31,31,.04) inset;
      padding: 14px 16px;
      margin: 0;
      transition: border-color .2s ease, box-shadow .2s ease;
    }
    .rf-fieldset:focus-within{
      border-color: var(--nogal);
      box-shadow: 0 0 0 2px rgba(119,107,93,.18);
    }
    .rf-checkboxes{
      display: grid;
      gap: 10px;
    }
    .rf-check{
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 12px 14px;
      border: 1px solid rgba(31,31,31,.18);
      border-radius: var(--radius);
      background: rgba(255,255,255,.03);
      font-family: var(--sans);
      font-size: 14px;
      line-height: 1.4;
      color: var(--ink);
      cursor: pointer;
      transition: border-color .15s ease, background .15s ease;
    }
    .rf-check:hover{
      border-color: var(--line-strong);
      background: rgba(31,31,31,.04);
    }
    .rf-check:has(input:checked){
      border-color: var(--nogal);
      background: rgba(119,107,93,.08);
    }
    .rf-check input{
      width: 20px;
      height: 20px;
      flex: 0 0 20px;
      accent-color: var(--nogal);
      cursor: pointer;
    }
    .rf-check span{
      flex: 1;
      overflow-wrap: anywhere;
      color: inherit;
    }
    .reserve-grid{
      display: grid;
      grid-template-columns: 1fr;
      row-gap: 18px;
      column-gap: 18px;
    }
    .reserve-grid > #rf-day-wrap{
      margin-top: 18px;
    }
    .rf-required{
      color: var(--nogal);
      font-weight: 600;
    }
    .reserve-hint{
      margin: 18px 0 0;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.5;
    }
    .reserve-hint.reserve-hint-error{
      color: var(--nogal);
      font-weight: 500;
    }

    /* Responsive */
    @media (max-width: 980px){
      .grid-3{ grid-template-columns:1fr; gap:14px; }
      .card{ padding:18px 18px 16px; border-radius: var(--radius); }
      .h3{ font-size:26px; }
      .h3.big{ font-size:28px; }
      .header-inner{ padding:14px 0; }
    }

    @media (max-width: 820px){
      .reserve-grid{ grid-template-columns:1fr; }

      .header-inner{ flex-wrap:wrap; }
      .tab{ flex:0 0 auto; }
      .modal-actions{ grid-template-columns:1fr; }
    }
  
    /* BONOS layout: flex wrap like other sections */
    #panel-bonos .grid-3{
      display:flex;
      flex-wrap:wrap;
      gap: var(--gap);
      max-width: var(--max);
      margin: 0 auto;
    }
    #panel-bonos .grid-3 > .card{
      flex: 1 1 360px; /* grows, wraps, keeps margins */
      min-width: 280px;
    }
    @media (max-width: 820px){
      #panel-bonos .grid-3 > .card{ flex-basis: 100%; }
    }
    /* Bonos text styles (editable) */
    #panel-bonos .bonos-title{
      font-family: var(--serif-display);
      font-weight:500;
      font-size:24px;
      line-height:1.08;
      margin:0 0 10px;
      color: var(--ink);
    }
    #panel-bonos .bonos-text{
      font-family: var(--sans);
      font-size:14px;
      line-height:1.75;
      margin:0 0 14px;
      max-width:62ch;
      color: var(--ink);
    }
    #panel-bonos .bonos-conditions-title{
      font-family: var(--serif-display);
      font-style: italic;
      color: var(--ink);
      margin:0 0 10px;
    }
    #panel-bonos .bonos-bullets{
      font-family: var(--sans);
      margin:0;
      padding-left:18px;
      color: var(--ink);
      font-size:14px;
      line-height:1.75;
    }
    /* Sin línea en dividers de bonos; mantener espacio considerable respecto al texto */
    #panel-bonos .divider{
      height: 0;
      background: transparent;
      margin: 24px 0;
    }

    .bonus-highlight{
      margin-top:16px;
      border:1px solid rgba(31,31,31,.28);
      border-radius: var(--radius);
      background: rgba(31,31,31,.03);
      padding:12px 16px;
      border-left: 4px solid var(--nogal);
    }
    .bonus-highlight span{
      display:block;
      font-family: var(--sans);
      font-size:14px;
      color: var(--ink);
      line-height:1.45;
    }
/* Sticky accordion (precios) */
    .sticky-accordion{
      position:fixed;
      left:0;
      right:0;
      bottom:0;
      z-index:70;
      background: rgba(235,227,213,.96);
      backdrop-filter: blur(10px);
      border-top:1px solid var(--line);
      padding-bottom: env(safe-area-inset-bottom);
    }
    .sticky-accordion .wrap{ padding-top:10px; padding-bottom:10px; }
    .acc-toggle{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(31,31,31,.03);
      padding:12px 14px;
      font-family: var(--sans);
      font-size:14px;
      color: var(--ink);
      cursor:pointer;
    }
    .acc-toggle:focus-visible{
      outline:4px solid rgba(31,31,31,.28);
      outline-offset:2px;
    }
    .chev{
      width:10px; height:10px;
      border-right:2px solid rgba(31,31,31,.6);
      border-bottom:2px solid rgba(31,31,31,.6);
      transform: rotate(45deg);
      transition: transform .18s ease;
      margin-right:2px;
      flex:0 0 auto;
    }
    .sticky-accordion.open .chev{ transform: rotate(-135deg); }
    .acc-panel{
      max-height:0;
      overflow:hidden;
      transition: max-height .22s ease;
    }
    .sticky-accordion.open .acc-panel{ max-height: 220px; }
    .acc-content{
      padding:12px 6px 0;
      display:grid;
      gap:12px;
    }
    .acc-text{
      margin:0;
      font-size:13px;
      line-height:1.6;
      color: var(--muted);
    }
    .cta-btn.secondary{
      background: transparent;
      border-color: var(--nogal);
      color: var(--nogal);
    }
    .cta-btn.cta-btn-disabled,
    .cta-btn[aria-disabled="true"]{
      opacity: 0.55;
      cursor: not-allowed;
      pointer-events: none;
    }


    /* Header actions (Reservar + Contáctanos) */
    .header-actions{
      display:flex;
      align-items:center;
      gap:16px;
      flex:0 0 auto;
    }
/* Footer */
.site-footer{
  border-top:1px solid var(--line);
  background: rgba(235,227,213,.76);
  padding:22px 0 28px;
  text-align:center;
}
.site-footer p{
  margin:0;
  font-size:13px;
  line-height:1.6;
  color: var(--muted);
  text-align:center;
}
.footer-top,
.footer-bottom{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
}
.footer-prices,
.footer-rights{
  max-width: 78ch;
}
.footer-actions{
  width:auto;
  display:flex;
  justify-content:center;
}
.footer-contact-btn{
  width:auto;
  min-width: 220px;
}
.footer-divider{
  height:1px;
  width:100vw;
  position:relative;
  left:50%;
  margin-left:-50vw;
  background: var(--line);
  margin-top:18px;
  margin-bottom:18px;
}
@media (max-width: 640px){
  .footer-actions{ width:100%; }
  .footer-contact-btn{
    width:100%;
    min-width: 0;
  }
}
</style>
</head>
<body>
<div data-view="carta" id="view-carta"><div id="carta" style="position:relative; top:-80px;"></div>
<!-- TOP STICKY (logo + tabs) -->
<div class="top-sticky">
<header class="site-header">
<div class="wrap">
<div class="header-inner">
<div class="brand">
<a href="#masajes" class="brand-logo-link" aria-label="Ir a Masajes">
<img alt="Ikigai · Centro de Masajes" class="brand-logo" decoding="async" loading="eager" onerror="this.style.display='none'; document.querySelector('.brand-fallback').style.display='flex';" src="./assets/images//Ikigai_Imagotipo-Horizontal-Color-Negativo-SF.svg"/>
<div class="brand-fallback">
<span class="word">ikigai</span>
<span class="sub">CENTRO DE MASAJES</span>
</div>
</a>
</div>
<div class="header-actions">
<a class="cta-btn primary reserve-btn" href="#reservas" id="go-reservas">Reservar</a>
</div>
</div>
</div>
</header>
<div aria-label="Secciones de la carta" class="tabs-bar" role="tablist">
<div class="wrap">
<div class="tabs-inner">
<button aria-controls="panel-masajes" aria-selected="true" class="tab" id="tab-masajes" role="tab" tabindex="0" type="button">
          Masajes terapéuticos
        </button>
<button aria-controls="panel-rituales" aria-selected="false" class="tab" id="tab-rituales" role="tab" tabindex="-1" type="button">
          Rituales
        </button>
<button aria-controls="panel-bonos" aria-selected="false" class="tab" id="tab-bonos" role="tab" tabindex="-1" type="button">
          Bonos
        </button>
</div>
</div>
</div>
</div>
<main>
<div class="wrap">
<!-- MASAJES -->
<section aria-hidden="false" aria-labelledby="tab-masajes" class="panel" id="panel-masajes" role="tabpanel">
<div class="grid-3">
<article class="card">
<h3 class="h3">Masaje relajante Ikigai</h3>
<div class="includes"></div>
<p class="p">
            Masaje suave y armonioso, ayuda a liberar el estrés, calmar la mente y relajar el cuerpo,
            mejorando el descanso y recuperando la sensación de bienestar y equilibrio.
          </p>
<div class="time-bar">
<div><span class="price">25 €</span><span class="time-sep">|</span><span class="duration">30 min</span></div>
<div><span class="price">40 €</span><span class="time-sep">|</span><span class="duration">50 min</span></div>
</div>
</article>
<article class="card card-featured">
<span class="card-flag">* Recomendado</span>
<h3 class="h3">Masaje de Tejido profundo</h3>
<div class="includes"></div>
<p class="p">
            Masaje enfocado en las capas más profundas del músculo, diseñado para liberar tensiones,
            rigidez y nudos musculares. Ayuda a aliviar molestias persistentes, mejorar la movilidad y
            devolver al cuerpo una sensación de ligereza.
          </p>
<div class="time-bar">
<div><span class="price">35 €</span><span class="time-sep">|</span><span class="duration">30 min</span></div>
<div><span class="price">55 €</span><span class="time-sep">|</span><span class="duration">50 min</span></div>
</div>
</article>
<article class="card">
<h3 class="h3">Masaje Californiano</h3>
<div class="includes"></div>
<p class="p">
            Masaje fluido y envolvente, conocido como una danza sanadora, que favorece la conexión
            cuerpo-mente, ayudando a soltar tensiones físicas y emocionales y a entrar en un profundo
            estado de relajación.
          </p>
<div class="time-bar single">
<div><span class="price">45 €</span><span class="time-sep">|</span><span class="duration">50 min</span></div>
</div>
</article>
<article class="card">
<h3 class="h3">Masaje con piedras calientes</h3>
<div class="includes"></div>
<p class="p">
            Masaje relajante que combina suaves movimientos con la aplicación de piedras volcánicas
            sobre puntos estratégicos del cuerpo. Ayuda a soltar tensiones acumuladas, relajar la
            musculatura y revitalizar la energía.
          </p>
<div class="time-bar single">
<div><span class="price">65 €</span><span class="time-sep">|</span><span class="duration">50 min</span></div>
</div>
</article>
<article class="card">
<h3 class="h3">Masaje craneal Hindú</h3>
<div class="includes"></div>
<p class="p">
            Masaje tradicional de la India que combina presión y movimientos ágiles sobre cabeza,
            cuello y hombros, ayuda a aliviar tensiones, reducir dolores de cabeza y estrés acumulado.
          </p>
<div class="time-bar single">
<div><span class="price">25 €</span><span class="time-sep">|</span><span class="duration">40 min</span></div>
</div>
</article>
<article class="card">
<h3 class="h3">Reflexología + Masaje de pies</h3>
<div class="includes"></div>
<p class="p">
            Tratamiento que combina la estimulación de puntos reflejos con un masaje profundo de pies,
            ayudando a liberar tensiones, mejorar la circulación y favorecer el equilibrio natural del
            cuerpo, proporcionando una sensación de ligereza y renovación.
          </p>
<div class="time-bar single">
<div><span class="price">35 €</span><span class="time-sep">|</span><span class="duration">40 min</span></div>
</div>
</article>
</div>
</section>
<!-- RITUALES -->
<section aria-hidden="true" aria-labelledby="tab-rituales" class="panel" id="panel-rituales" role="tabpanel">
<div class="grid-3">
<article class="card">
<h3 class="h3">Ritual Ikigai</h3>
<div class="includes">
<div class="includes-title">Incluye</div>
<div class="includes-row">
<div><strong>Bañera de Hidromasaje<br/><span>con aromaterapia</span></strong></div>
<div class="includes-time">30 min</div>
</div>
<div class="includes-row">
<div><strong>Masaje a elegir:</strong><br/>Relajante o de Tejido profundo</div>
<div class="includes-time">50 min</div>
</div>
<div class="includes-row">
<div><strong>Tratamiento final a elegir:</strong><br/>Mini facial o Masaje de pies</div>
<div class="includes-time">30 min</div>
</div>
</div>
<div class="price-bar"><span class="card-price">115 €</span></div>
</article>
<article class="card">
<h3 class="h3">Ritual <em>Exprés</em> Ikigai</h3>
<div class="includes">
<div class="includes-title">Incluye</div>
<div class="includes-row">
<div><strong>Bañera de Hidromasaje</strong></div>
<div class="includes-time">25 min</div>
</div>
<div class="includes-row">
<div><strong>Masaje relajante localizado:</strong><br/>espalda o piernas</div>
<div class="includes-time">25 min</div>
</div>
</div>
<div class="price-bar"><span class="card-price">60 €</span></div>
</article>
<article class="card">
<h3 class="h3">Ritual Ikigai <em>en pareja</em></h3>
<div class="includes">
<div class="includes-title">Incluye</div>
<div class="includes-row">
<div><strong>Bañera de Hidromasaje<br/><span>con aromaterapia</span></strong></div>
<div class="includes-time">50 min</div>
</div>
<!-- Same line note -->
<div class="includes-row">
<div>
<strong>Masaje relajante</strong><br/><span style="color:var(--muted)">(Masajes realizados de forma consecutiva,</span> <br/><span style="color:var(--muted)"> no simultánea)</span>
</div>
<div class="includes-time">25 min p/p</div>
</div>
<div class="includes-row">
<div><strong>Bombones y Cava</strong></div>
<div class="includes-time"></div>
</div>
</div>
<div class="price-bar"><span class="card-price">150 €</span></div>
</article>
</div>
</section>
<!-- BONOS -->
<section aria-hidden="true" aria-labelledby="tab-bonos" class="panel" id="panel-bonos" role="tabpanel">
<div class="grid-3">
<article class="card">
<h3 class="h3 bonos-title">Bono mensual</h3>
<div class="includes"></div>
<p class="p bonos-text">
            Este bono está pensado para personas que sienten tensión y sobrecarga corporal que desean un espacio regular de cuidado.
          </p>
<p class="p bonos-text">
            La continuidad de las sesiones favorece una mayor sensación de bienestar, ligereza y equilibrio, respetando siempre el ritmo del cuerpo
          </p>
<div class="divider"></div>
<div aria-label="Detalle del bono" class="bonus-highlight">
<span>4 sesiones · Masaje de Tejido profundo (50 min por sesión)</span>
</div>
<div class="divider"></div>
<div class="cond-title bonos-conditions-title">Condiciones</div>
<ul class="bullets bonos-bullets">
<li>Bono personal e intransferible.</li>
<li>Reserva previa.</li>
<li>Validez de 2 meses.</li>
</ul>
<div class="price-bar"><span class="card-price">200 €</span></div>
</article>
<article class="card">
<h3 class="h3 bonos-title">Bono regalo</h3>
<div class="includes"></div>
<p class="p bonos-text">
Este bono regalo está pensado para ofrecer una experiencia de cuidado y bienestar, un momento de pausa y conexión con el cuerpo en un entorno tranquilo y respetuoso.          </p>
<p class="p bonos-text">
Con este bono regalo podrás elegir entre todos los servicios disponibles o combinarlos entre sí, adaptando la experiencia a las necesidades y preferencias de cada persona.          </p>
<div class="divider"></div>
<div aria-label="Detalle del bono" class="bonus-highlight">
<span>Personalízalo en el momento de la reserva</span>
</div>
<div class="divider"></div>
<div class="cond-title bonos-conditions-title">Condiciones</div>
<ul class="bullets bonos-bullets">
<li>Bono personal e intransferible.</li>
<li>Reserva previa obligatoria.</li>
<li>Validez de 1 año.</li>
</ul>
<div class="price-bar"><span class="card-price">Precio según personalización</span></div>
</article>
</div>
</section>
</div>
</main>
</div>
<div data-view="reservas" id="view-reservas" style="display:none;"><div id="reservas" style="position:relative; top:-80px;"></div>
<div class="top-sticky">
<header class="site-header">
<div class="wrap">
<div class="header-inner">
<div class="brand">
<a href="#masajes" class="brand-logo-link" aria-label="Ir a Masajes">
<img alt="Ikigai · Centro de Masajes" class="brand-logo" decoding="async" loading="eager" onerror="this.style.display='none'; document.querySelector('.brand-fallback').style.display='flex';" src="./assets/images//Ikigai_Imagotipo-Horizontal-Color-Negativo-SF.svg"/>
<div class="brand-fallback">
<span class="word">ikigai</span>
<span class="sub">CENTRO DE MASAJES</span>
</div>
</a>
</div>
<div class="header-actions">
<a class="cta-btn secondary reserve-btn" href="#carta" rel="noopener">Ver Carta</a>
</div>
</div>
</div>
</header>
</div>
<main>
<div class="wrap">
<div class="booking-wrap">
<section aria-label="Reserva" class="card booking-card">
<h1 class="modal-title">Reserva tiempo para ti.</h1>
<p class="modal-body">¿Tienes claro lo que necesitas?
<br>Indícanos el servicio que deseas y una preferencia de día. Nos pondremos en contacto contigo lo antes posible para confirmar la disponibilidad.</br></p>
<div aria-label="Preferencias de reserva" class="reserve-form">
<label class="rf">
<span>Nombre <span class="rf-required" aria-hidden="true">*</span></span>
<div class="rf-control">
<input autocomplete="name" id="rf-name" placeholder="Escribe tu nombre" type="text"/>
<button aria-label="Borrar nombre" class="rf-clear" data-for="rf-name" type="button" hidden>
<span aria-hidden="true" class="x"></span>
</button>
</div>
</label>
<label class="rf">
<span>Tipo de servicio <span class="rf-required" aria-hidden="true">*</span></span>
<div class="rf-control">
<select id="rf-type">
<option disabled="" selected="" value="">Selecciona un tipo de servicio</option>
<option value="masaje">Masaje terapéutico</option>
<option value="ritual">Ritual</option>
<option value="bono_mensual">Bono mensual</option>
<option value="bono_regalo">Bono regalo</option>
</select>
<button aria-label="Borrar tipo de servicio" class="rf-clear" data-for="rf-type" type="button" hidden>
<span aria-hidden="true" class="x"></span>
</button>
</div>
</label>
<div class="reserve-grid" id="rf-dependent">
<div class="rf" id="rf-treatment-wrap" style="display:none;">
<span>Tratamiento <span class="rf-required" aria-hidden="true">*</span></span>
<div class="rf-control">
<select disabled="" id="rf-treatment">
<option disabled="" selected="" value="">Selecciona un tratamiento</option>
</select>
<button aria-label="Borrar tratamiento" class="rf-clear" data-for="rf-treatment" type="button" hidden>
<span aria-hidden="true" class="x"></span>
</button>
</div>
<!-- Accessible multi-select (checkbox list) -->
<div class="rf-control-fieldset">
<fieldset class="rf-fieldset" disabled="" hidden="" id="rf-treatment-fieldset">
<legend class="sr-only">Tratamientos</legend>
<div class="rf-checkboxes" id="rf-treatment-checkboxes"></div>
</fieldset>
<button aria-label="Borrar tratamientos" class="rf-clear rf-clear-fieldset" data-for="rf-treatment-fieldset" type="button" hidden>
<span aria-hidden="true" class="x"></span>
</button>
</div>
</div>
<label class="rf" id="rf-day-wrap" style="display:none;">
<span>Fecha <span class="rf-required" aria-hidden="true">*</span></span>
<div class="rf-control">
<div class="ikigai-date-wrap">
<input disabled="" id="rf-day" type="text" placeholder="DD/MM/AAAA" readonly="" autocomplete="off"/>
<div class="ikigai-calendar" id="ikigai-cal" role="dialog" aria-label="Seleccionar fecha" aria-hidden="true"></div>
</div>
<button aria-label="Borrar fecha" class="rf-clear" data-for="rf-day" type="button" hidden>
<span aria-hidden="true" class="x"></span>
</button>
</div>
</label>
</div>
<p aria-live="polite" class="reserve-hint" id="rf-hint"></p>
</div>
<div class="modal-actions">
<a class="cta-btn primary" href="#" id="reserve-whatsapp" rel="noopener" target="_blank">Reservar por WhatsApp</a>
<a class="cta-btn secondary" href="#" id="reserve-email">Reservar por correo</a>
</div>
</section>
</div>
</div>
</main>
</div>
<footer class="site-footer">
<div class="wrap">
<div class="footer-top">
<p class="footer-prices">Para conocer más información sobre nosotros o nuestros servicios, contacta con nosotros.</p>
<div class="footer-actions">
<button aria-controls="consult-modal" aria-haspopup="dialog" class="cta-btn secondary contact-btn footer-contact-btn" id="open-contact-footer" type="button">Contáctanos</button>
</div>
</div>
<div class="footer-divider" role="presentation"></div>
<div class="footer-bottom">
<p class="footer-instagram">
  Síguenos en Instagram ·
  <a href="#" id="ig-link" target="_blank" rel="noopener" data-ig-web="https://www.instagram.com/centroikigai.masajes/">
    @centroikigai.masajes
  </a>
</p>
</div>
<div class="footer-divider" role="presentation"></div>
<div class="footer-bottom">
<p class="footer-rights">Todos los derechos reservados para <br> Ikigai · Centro de Masajes </br></p>
</div>
</div>
</footer>
<!-- Consult modal -->
<div aria-hidden="true" aria-labelledby="consult-title" aria-modal="true" class="modal" id="consult-modal" role="dialog">
<div class="modal-backdrop" data-close="true"></div>
<div class="modal-card" role="document">
<button aria-label="Cerrar" class="modal-close" data-close="true" type="button">
<span aria-hidden="true" class="x"></span>
</button>
<h2 class="modal-title" id="consult-title">Contáctanos</h2>
<p class="modal-body">Puedes hacerlo pulsando abajo, mediante WhatsApp o correo.</p>
<div class="modal-actions">
<a class="cta-btn primary" href="#" id="consult-whatsapp" rel="noopener" target="_blank">
        WhatsApp
      </a>
<a class="cta-btn secondary" href="#" id="consult-email">
        Correo
      </a>
</div>
</div>
</div>
<script>
(function(){
  const viewCarta = document.getElementById('view-carta');
  const viewReservas = document.getElementById('view-reservas');

  function setView(){
    const hash = (window.location.hash || '#carta').toLowerCase();
    const showReservas = (hash === '#reservas');
    if(viewCarta) viewCarta.style.display = showReservas ? 'none' : 'block';
    if(viewReservas) viewReservas.style.display = showReservas ? 'block' : 'none';

    // Make sure we start at the top of the visible view
    if(showReservas){
      const a = document.getElementById('reservas');
      if(a) a.scrollIntoView({block:'start'});
    } else {
      const a = document.getElementById('carta');
      if(a) a.scrollIntoView({block:'start'});
    }
  }

  window.addEventListener('hashchange', setView);
  document.addEventListener('DOMContentLoaded', setView);
})();
</script><script>
(function(){
    const tabs = Array.from(document.querySelectorAll('[role="tab"]'));
    const panels = tabs.map(t => document.getElementById(t.getAttribute('aria-controls')));

    function scrollToTop(){
      const carta = document.getElementById('carta');
      if(carta) carta.scrollIntoView({ behavior: 'smooth', block: 'start' });
      else window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function setActive(tab){
      tabs.forEach((t, i) => {
        const active = (t === tab);
        t.setAttribute('aria-selected', active ? 'true' : 'false');
        t.setAttribute('tabindex', active ? '0' : '-1');
        panels[i].setAttribute('aria-hidden', active ? 'false' : 'true');
      });

      const id = tab.id.replace('tab-','');
      history.replaceState(null, '', '#' + id);
      scrollToTop();
    }

    tabs.forEach(t => {
      t.addEventListener('click', () => setActive(t));
      t.addEventListener('keydown', (e) => {
        const idx = tabs.indexOf(t);
        if(e.key === 'ArrowRight'){ e.preventDefault(); tabs[(idx+1)%tabs.length].focus(); }
        if(e.key === 'ArrowLeft'){ e.preventDefault(); tabs[(idx-1+tabs.length)%tabs.length].focus(); }
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); setActive(t); }
      });
    });

    function syncTabFromHash(){
      const hash = (location.hash || '').replace('#','').trim();
      if(hash && ['masajes','rituales','bonos'].includes(hash)){
        const target = document.getElementById('tab-' + hash);
        if(target) setActive(target);
      }
    }

    syncTabFromHash();
    window.addEventListener('hashchange', syncTabFromHash);
  })();
</script><script>
(function(){
    const get = (id) => document.getElementById(id);

    const consultModal = get('consult-modal');
    const consultOpenBtns = [ get('open-contact-footer') ].filter(Boolean);

    const PHONE_NUMBER = "34722712587"; // digits only
    const EMAIL = "centroikigai.masajes@gmail.com";

    // ---------- Modal helpers (consult only) ----------
    const focusablesSelector = 'a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])';
    let lastActiveEl = null;

    function getFocusable(modalEl){
      return Array.from(modalEl.querySelectorAll(focusablesSelector))
        .filter(el => el.offsetParent !== null);
    }

    function openModal(modalEl){
      if(!modalEl) return;
      lastActiveEl = document.activeElement;
      modalEl.setAttribute('aria-hidden','false');
      document.body.style.overflow = 'hidden';
      const f = getFocusable(modalEl);
      (f[0] || modalEl).focus?.();
    }

    function closeModal(modalEl){
      if(!modalEl) return;
      modalEl.setAttribute('aria-hidden','true');
      document.body.style.overflow = '';
      lastActiveEl?.focus?.();
    }

    function wireModal(modalEl){
      if(!modalEl) return;
      modalEl.addEventListener('click', (e) => {
        const t = e.target;
        if(t?.closest?.('[data-close="true"]')) closeModal(modalEl);
      });

      modalEl.addEventListener('keydown', (e) => {
        if(e.key === 'Escape') closeModal(modalEl);

        if(e.key === 'Tab'){
          const f = getFocusable(modalEl);
          if(!f.length) return;
          const first = f[0];
          const last = f[f.length - 1];

          if(e.shiftKey && document.activeElement === first){
            e.preventDefault(); last.focus();
          } else if(!e.shiftKey && document.activeElement === last){
            e.preventDefault(); first.focus();
          }
        }
      });
    }

    wireModal(consultModal);

    consultOpenBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        openModal(consultModal);
        updateConsultLinks();
      });
    });

    // ---------- Reservation data (hardcoded for reservation page) ----------
    const MASAJES = [
      "Masaje relajante Ikigai (30 min)",
      "Masaje relajante Ikigai (50 min)",
      "Masaje de Tejido profundo (30 min)",
      "Masaje de Tejido profundo (50 min)",
      "Masaje Californiano",
      "Masaje con piedras calientes",
      "Masaje craneal Hindú",
      "Reflexología + Masaje de pies"
    ];

    const RITUALES = [
      "Ritual Ikigai",
      "Ritual Exprés Ikigai",
      "Ritual Ikigai en pareja"
    ];

    // ---------- Reservation form logic ----------
    const typeSel = get('rf-type');
    const nameInput = get('rf-name');
    const treatmentWrap = get('rf-treatment-wrap');
    const treatmentSel = get('rf-treatment');
    const treatmentFieldset = get('rf-treatment-fieldset');
    const treatmentCheckboxes = get('rf-treatment-checkboxes');
    const dayWrap = get('rf-day-wrap');
    const dayInput = get('rf-day');
    const hintEl = get('rf-hint');

    function optionEl(value){
      const o = document.createElement('option');
      o.value = value;
      o.textContent = value;
      return o;
    }

    function resetSelect(selectEl){
      if(!selectEl) return;
      selectEl.value = '';
      Array.from(selectEl.options).forEach((opt, idx) => {
        if(idx === 0) return; // keep placeholder
        opt.remove();
      });
    }

    function resetCheckboxes(){
      if(!treatmentCheckboxes) return;
      treatmentCheckboxes.innerHTML = "";
    }

    function setTreatmentMode(mode){
      // mode: "single" | "multi"
      if(mode === 'multi'){
        if(treatmentSel){
          treatmentSel.style.display = 'none';
          treatmentSel.setAttribute('disabled','disabled');
        }
        if(treatmentFieldset){
          treatmentFieldset.hidden = false;
          treatmentFieldset.removeAttribute('disabled');
        }
      } else {
        if(treatmentSel){
          treatmentSel.style.display = '';
          treatmentSel.removeAttribute('disabled');
        }
        if(treatmentFieldset){
          treatmentFieldset.hidden = true;
          treatmentFieldset.setAttribute('disabled','disabled');
        }
        resetCheckboxes();
      }
    }

    function setVisible(el, visible){
      if(!el) return;
      el.style.display = visible ? '' : 'none';
    }

    function configureFormFor(type){
      // Hide everything by default until there's a type
      if(!type){
        setVisible(treatmentWrap, false);
        setVisible(dayWrap, false);

        treatmentSel?.setAttribute('disabled','disabled');
        dayInput?.setAttribute('disabled','disabled');

        if(hintEl) hintEl.textContent = "Selecciona primero el tipo de servicio para continuar.";
        setTreatmentMode('single');
        resetSelect(treatmentSel);
        if(dayInput){ dayInput.value = ''; }
        updateReserveLinks();
        return;
      }

      setVisible(treatmentWrap, true);
      setTreatmentMode('single');
      resetSelect(treatmentSel);

      if(type === 'masaje'){
        MASAJES.forEach(n => treatmentSel?.appendChild(optionEl(n)));
        setVisible(dayWrap, true);
        dayInput?.removeAttribute('disabled');
        if(hintEl) hintEl.textContent = "Selecciona tratamiento y fecha. El mensaje se completará automáticamente.";
      }

      if(type === 'ritual'){
        RITUALES.forEach(n => treatmentSel?.appendChild(optionEl(n)));
        setVisible(dayWrap, true);
        dayInput?.removeAttribute('disabled');
        if(hintEl) hintEl.textContent = "Selecciona tratamiento y fecha. El mensaje se completará automáticamente.";
      }

      if(type === 'bono_mensual'){
        const bonoMensualTreatment = 'Masaje de Tejido profundo';
        treatmentSel?.appendChild(optionEl(bonoMensualTreatment));
        if(treatmentSel){
          treatmentSel.value = bonoMensualTreatment;
          treatmentSel.dispatchEvent(new Event('change', { bubbles: true }));
        }
        setVisible(dayWrap, false);
        if(dayInput){
          dayInput.value = '';
        }
        dayInput?.setAttribute('disabled','disabled');
        if(hintEl) hintEl.textContent = "Bono mensual: selecciona el tratamiento. Confirmaremos disponibilidad contigo.";
      }

      if(type === 'bono_regalo'){
        const all = [...MASAJES, ...RITUALES];
        setTreatmentMode('multi');
        resetCheckboxes();

        if(treatmentCheckboxes){
          all.forEach((name, idx) => {
            const id = `rf-treat-${idx}`;
            const row = document.createElement('label');
            row.className = 'rf-check';
            row.setAttribute('for', id);

            const input = document.createElement('input');
            input.type = 'checkbox';
            input.id = id;
            input.value = name;

            const text = document.createElement('span');
            text.textContent = name;

            row.appendChild(input);
            row.appendChild(text);
            treatmentCheckboxes.appendChild(row);
          });
        }

        setVisible(dayWrap, false);
        if(dayInput){
          dayInput.value = '';
        }
        dayInput?.setAttribute('disabled','disabled');
        if(hintEl) hintEl.textContent = "Bono regalo: puedes seleccionar varios tratamientos.";
      }

      updateReserveLinks();
    }

    function formatDateES(iso){
      if(!iso) return "";
      const parts = iso.split('-').map(Number);
      const y = parts[0], m = parts[1], d = parts[2];
      if(!y || !m || !d) return iso;
      return `${String(d).padStart(2,'0')}/${String(m).padStart(2,'0')}/${y}`;
    }

    function typeLabel(type){
      switch(type){
        case 'masaje': return 'Masaje terapéutico';
        case 'ritual': return 'Ritual';
        case 'bono_mensual': return 'Bono mensual';
        case 'bono_regalo': return 'Bono regalo';
        default: return '';
      }
    }

    function selectedTreatments(){
      if(treatmentFieldset && !treatmentFieldset.hidden){
        return Array.from(treatmentFieldset.querySelectorAll('input[type="checkbox"]'))
          .filter(i => i.checked)
          .map(i => (i.value || '').trim())
          .filter(Boolean);
      }

      if(!treatmentSel) return [];
      return Array.from(treatmentSel.selectedOptions || [])
        .map(o => (o.value || o.textContent || '').trim())
        .filter(Boolean);
    }

    function isReserveFormValid(){
      return getMissingReserveFields().length === 0;
    }

    function getMissingReserveFields(){
      const missing = [];
      const name = (nameInput?.value || "").trim();
      const type = typeSel?.value || "";
      if(!name) missing.push('Nombre');
      if(!type) missing.push('Tipo de servicio');
      if(!type) return missing;
      if(type === 'masaje' || type === 'ritual'){
        const treatments = selectedTreatments();
        const day = (dayInput?.value || "").trim();
        if(treatments.length === 0) missing.push('Tratamiento');
        if(!day) missing.push('Fecha');
      } else if(type === 'bono_regalo'){
        if(selectedTreatments().length === 0) missing.push('Tratamiento(s)');
      }
      return missing;
    }

    function showMissingFieldsAlert(){
      const missing = getMissingReserveFields();
      if(missing.length === 0) return;
      const msg = 'Por favor, completa los siguientes campos: ' + missing.join(', ');
      if(hintEl){
        hintEl.textContent = msg;
        hintEl.setAttribute('role', 'alert');
        hintEl.classList.add('reserve-hint-error');
        hintEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }
    }

    function buildReserveMessage(){
      const type = typeSel?.value || "";
      const typeText = typeLabel(type);
      const name = (nameInput?.value || "").trim();
      const treatments = selectedTreatments();
      const day = formatDateES(dayInput?.value || "");

      const lines = [];
      lines.push("Hola, me gustaría hacer la siguiente reserva:");
      lines.push("");
      if(name) lines.push(`Nombre - ${name}`);
      if(typeText) lines.push(`Tipo de servicio - ${typeText}`);

      if(type === 'bono_regalo'){
        if(treatments.length) lines.push(`Tratamientos - ${treatments.join(", ")}`);
      } else {
        if(treatments.length) lines.push(`Tratamiento - ${treatments[0]}`);
      }

      if((type === 'masaje' || type === 'ritual') && day) lines.push(`Fecha - ${day}`);

      lines.push("");
      lines.push("Gracias");
      return lines.join("\n");
    }

    function buildReserveEmailBody(){
      return buildReserveMessage().replace(/ - /g, ": ");
    }

    function updateReserveLinks(){
      hintEl?.classList.remove('reserve-hint-error');
      const waBtn = get('reserve-whatsapp');
      const mailBtn = get('reserve-email');
      const valid = isReserveFormValid();

      if(!valid){
        if(waBtn){
          waBtn.href = '#';
          waBtn.removeAttribute('data-href');
          waBtn.setAttribute('aria-disabled', 'true');
          waBtn.classList.add('cta-btn-disabled');
        }
        if(mailBtn){
          mailBtn.href = '#';
          mailBtn.removeAttribute('data-mailto');
          mailBtn.removeAttribute('data-gmail');
          mailBtn.setAttribute('aria-disabled', 'true');
          mailBtn.classList.add('cta-btn-disabled');
        }
        return;
      }

      const waText = encodeURIComponent(buildReserveMessage());
      const waURL = `https://wa.me/${PHONE_NUMBER}?text=${waText}`;

      const subject = encodeURIComponent("Reserva - Ikigai");
      const body = encodeURIComponent(buildReserveEmailBody()).replace(/%0A/g, "%0D%0A");
      const mailtoURL = `mailto:${EMAIL}?subject=${subject}&body=${body}`;
      const gmailURL = `https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(EMAIL)}&su=${subject}&body=${body}`;

      if(waBtn){
        waBtn.href = waURL;
        waBtn.dataset.href = waURL;
        waBtn.rel = 'noopener';
        waBtn.target = '_blank';
        waBtn.removeAttribute('aria-disabled');
        waBtn.classList.remove('cta-btn-disabled');
      }

      if(mailBtn){
        mailBtn.href = mailtoURL;
        mailBtn.dataset.mailto = mailtoURL;
        mailBtn.dataset.gmail = gmailURL;
        mailBtn.removeAttribute('target');
        mailBtn.setAttribute('rel', 'noopener');
        mailBtn.removeAttribute('aria-disabled');
        mailBtn.classList.remove('cta-btn-disabled');
      }
    }

    function isMobile(){
      return window.matchMedia('(max-width: 768px)').matches;
    }

    function attachReserveLinkGuards(){
      const waBtn = get('reserve-whatsapp');
      const mailBtn = get('reserve-email');

      waBtn?.addEventListener('click', (e) => {
        if(!isReserveFormValid()){
          e.preventDefault();
          showMissingFieldsAlert();
          return;
        }
        const url = waBtn.dataset.href || waBtn.getAttribute('href');
        if(!url || url === '#'){ e.preventDefault(); return; }
        e.preventDefault();
        window.open(url, '_blank', 'noopener');
      });

      mailBtn?.addEventListener('click', (e) => {
        if(!isReserveFormValid()){
          e.preventDefault();
          showMissingFieldsAlert();
          return;
        }
        e.preventDefault();
        const mailto = mailBtn.dataset.mailto;
        const gmail = mailBtn.dataset.gmail;
        if(isMobile() && mailto) window.location.href = mailto;
        else if(gmail){ const w = window.open(gmail, '_blank'); if(!w && mailto) window.location.href = mailto; }
      });
    }

    // ---------- Consult links ----------
    function updateConsultLinks(){
      const waBtn = get('consult-whatsapp');
      const mailBtn = get('consult-email');

      const consultText = encodeURIComponent("Hola, me gustaría pedir más información sobre");
      const waURL = `https://wa.me/${PHONE_NUMBER}?text=${consultText}`;

      const subject = encodeURIComponent("Consulta - Ikigai");
      const body = encodeURIComponent("Hola, me gustaría pedir más información sobre").replace(/%0A/g, "%0D%0A");
      const mailtoURL = `mailto:${EMAIL}?subject=${subject}&body=${body}`;
      const gmailURL = `https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(EMAIL)}&su=${subject}&body=${body}`;

      if(waBtn){
        waBtn.href = waURL;
        waBtn.dataset.href = waURL;
        waBtn.rel = 'noopener';
        waBtn.target = '_blank';
      }
      if(mailBtn){
        mailBtn.href = mailtoURL;
        mailBtn.dataset.mailto = mailtoURL;
        mailBtn.dataset.gmail = gmailURL;
        mailBtn.removeAttribute('target');
        mailBtn.setAttribute('rel', 'noopener');
      }
    }

    function attachConsultLinkGuards(){
      const waBtn = get('consult-whatsapp');
      const mailBtn = get('consult-email');

      waBtn?.addEventListener('click', (e) => {
        const url = waBtn.dataset.href || waBtn.getAttribute('href');
        if(!url || url === '#') return;
        e.preventDefault();
        window.open(url, '_blank', 'noopener');
      });

      mailBtn?.addEventListener('click', (e) => {
        e.preventDefault();
        const mailto = mailBtn.dataset.mailto;
        const gmail = mailBtn.dataset.gmail;
        if(isMobile() && mailto) window.location.href = mailto;
        else if(gmail){ const w = window.open(gmail, '_blank'); if(!w && mailto) window.location.href = mailto; }
      });
    }

// ---------- Clear (X) buttons ----------
const clearBtns = Array.from(document.querySelectorAll('.rf-clear'));

function dispatchChange(el){
  if(!el) return;
  el.dispatchEvent(new Event('input', { bubbles:true }));
  el.dispatchEvent(new Event('change', { bubbles:true }));
}

function clearField(targetId){
  const el = get(targetId);
  if(!el) return;

  if(el.tagName === 'SELECT' || el.tagName === 'INPUT' || el.tagName === 'TEXTAREA'){
    el.value = '';
    dispatchChange(el);
    return;
  }

  // Fieldset multi-select
  if(el.tagName === 'FIELDSET'){
    const boxes = Array.from(el.querySelectorAll('input[type="checkbox"]'));
    boxes.forEach(b => b.checked = false);
    el.dispatchEvent(new Event('change', { bubbles:true }));
    return;
  }
}

function refreshClearButtons(){
  clearBtns.forEach(btn => {
    const targetId = btn.dataset.for;
    const el = targetId ? get(targetId) : null;
    if(!el){
      btn.hidden = true;
      return;
    }

    // Hide if target isn't visible
    const isHidden = (el.hidden === true) || (el.offsetParent === null);
    const isDisabled = !!el.disabled;

    if(el.tagName === 'FIELDSET'){
      const anyChecked = !!el.querySelector('input[type="checkbox"]:checked');
      btn.hidden = isHidden || isDisabled || !anyChecked;
      return;
    }

    const hasValue = (el.value || '').trim() !== '';
    btn.hidden = isHidden || isDisabled || !hasValue;
  });
}

clearBtns.forEach(btn => {
  btn.addEventListener('click', () => {
    clearField(btn.dataset.for);
    updateReserveLinks();
    refreshClearButtons();
  });
});

    // ---------- Wire form events ----------
    typeSel?.addEventListener('change', () => { configureFormFor(typeSel.value); refreshClearButtons(); });

    [nameInput, treatmentSel, dayInput].forEach(el => {
      el?.addEventListener('change', () => { updateReserveLinks(); refreshClearButtons(); });
      el?.addEventListener('input', () => { updateReserveLinks(); refreshClearButtons(); });
    });
    treatmentCheckboxes?.addEventListener('change', () => { updateReserveLinks(); refreshClearButtons(); });

    // Calendario personalizado Ikigai
    const calEl = document.getElementById('ikigai-cal');
    const MESES = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
    const DIAS_SEM = ['Lu','Ma','Mi','Ju','Vi','Sá','Do'];
    let calYear, calMonth;

    function toISO(y,m,d){ return y+'-'+String(m).padStart(2,'0')+'-'+String(d).padStart(2,'0'); }
    function isBeforeToday(iso){
      const t = new Date(); t.setHours(0,0,0,0);
      const d = new Date(iso+'T12:00:00'); d.setHours(0,0,0,0);
      return d < t;
    }
    function isCurrentMonth(){ const t = new Date(); return calYear===t.getFullYear() && calMonth===t.getMonth(); }
    function renderCal(){
      if(!calEl || !dayInput) return;
      const d = new Date(calYear, calMonth, 1);
      const lastDay = new Date(calYear, calMonth+1, 0).getDate();
      const firstDow = (d.getDay() + 6) % 7; // Lu=0
      const today = new Date();
      const prevDisabled = isCurrentMonth();
      let html = '<div class="ikigai-cal-head"><span class="ikigai-cal-title">'+MESES[calMonth]+' '+calYear+'</span>';
      html += '<div class="ikigai-cal-nav"><button type="button" class="ikigai-cal-nav-btn" aria-label="Mes anterior" '+(prevDisabled?'disabled':'')+'>‹</button>';
      html += '<button type="button" class="ikigai-cal-nav-btn" aria-label="Mes siguiente">›</button></div></div>';
      html += '<div class="ikigai-cal-weekdays">'+DIAS_SEM.map(w=>'<span class="ikigai-cal-weekday">'+w+'</span>').join('')+'</div>';
      html += '<div class="ikigai-cal-days">';
      for(let i=0;i<firstDow;i++) html += '<span class="ikigai-cal-day other"></span>';
      const selVal = dayInput.value; // YYYY-MM-DD
      for(let day=1;day<=lastDay;day++){
        const date = new Date(calYear, calMonth, day);
        const sun = date.getDay()===0;
        const iso = toISO(calYear,calMonth+1,day);
        const sel = (selVal===iso);
        const past = isBeforeToday(iso);
        const noclk = sun || past;
        let cls = 'ikigai-cal-day';
        if(calMonth!==date.getMonth()) cls+=' other';
        if(sun) cls+=' disabled';
        if(past) cls+=' past';
        if(sel) cls+=' selected';
        html += '<button type="button" class="'+cls+'" data-date="'+iso+'" '+(noclk?'disabled':'')+'>'+day+'</button>';
      }
      html += '</div>';
      calEl.innerHTML = html;

      calEl.querySelectorAll('.ikigai-cal-day:not(.disabled):not(.other):not(.past)').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const iso = btn.dataset.date;
          const d = new Date(iso+'T12:00:00');
          if(d.getDay()===0){
            dayInput.value = '';
            if(hintEl) hintEl.textContent = 'Los domingos no estamos abiertos. Elige otro día.';
          } else {
            dayInput.value = iso;
            dayInput.dispatchEvent(new Event('input',{bubbles:true}));
            dayInput.dispatchEvent(new Event('change',{bubbles:true}));
            updateReserveLinks();
            refreshClearButtons();
          }
          closeCal();
        });
      });
    }

    function openCal(){
      const v = dayInput.value;
      if(v){
        const p = v.split('-').map(Number);
        calYear = p[0]; calMonth = (p[1]||1)-1;
      } else {
        const t = new Date();
        calYear = t.getFullYear(); calMonth = t.getMonth();
      }
      renderCal();
      calEl.classList.add('open');
      calEl.setAttribute('aria-hidden','false');
    }
    function closeCal(){
      calEl.classList.remove('open');
      calEl.setAttribute('aria-hidden','true');
    }

    calEl.addEventListener('click', function(e){
      const navBtn = e.target.closest('.ikigai-cal-nav-btn');
      if(navBtn){
        e.preventDefault();
        e.stopPropagation();
        if(navBtn.disabled) return;
        const nav = navBtn.closest('.ikigai-cal-nav');
        const isPrev = nav && nav.firstElementChild === navBtn;
        if(isPrev){ calMonth--; if(calMonth<0){ calMonth=11; calYear--; } }
        else{ calMonth++; if(calMonth>11){ calMonth=0; calYear++; } }
        renderCal();
      }
    });

    const dateWrap = dayInput?.closest('.ikigai-date-wrap');
    dateWrap?.addEventListener('click', function(e){
      if(e.target.closest('.rf-clear')) return;
      if(e.target.closest('.ikigai-calendar')) return; /* clic dentro del calendario no alterna */
      if(dayInput.disabled) return;
      e.stopPropagation();
      if(calEl.classList.contains('open')) closeCal();
      else openCal();
    });
    document.addEventListener('click', function(e){
      if(!dateWrap?.contains(e.target)) closeCal();
    });
    document.addEventListener('keydown', function(e){ if(e.key==='Escape') closeCal(); });

    // Los domingos no hay reservas (validación al cambiar)
    dayInput?.addEventListener('change', function(){
      const v = dayInput.value;
      if(!v) return;
      const d = new Date(v + 'T12:00:00');
      if(d.getDay() === 0){
        dayInput.value = '';
        if(hintEl) hintEl.textContent = 'Los domingos no estamos abiertos. Elige otro día.';
        updateReserveLinks();
        refreshClearButtons();
      } else if(hintEl && typeSel){
        const type = typeSel.value;
        if(type === 'masaje' || type === 'ritual') hintEl.textContent = "Selecciona tratamiento y fecha. El mensaje se completará automáticamente.";
        else if(type === 'bonos') hintEl.textContent = "Bono mensual: selecciona el tratamiento. Confirmaremos disponibilidad contigo.";
      }
    });

    // Init
    configureFormFor(typeSel?.value || "");
    updateReserveLinks();
    updateConsultLinks();
    attachReserveLinkGuards();
    attachConsultLinkGuards();
    refreshClearButtons();
  })();
</script>
<script>
/* Instagram: en móvil evitamos que el OS abra la app interceptando el enlace.
   Abrimos con JS la versión web (m.instagram.com) para que cargue en el navegador. */
(function(){
  const ig = document.getElementById('ig-link');
  if(!ig) return;
  var webUrl = ig.getAttribute('data-ig-web') || 'https://www.instagram.com/centroikigai.masajes/';
  var mobileWebUrl = 'https://www.instagram.com/centroikigai.masajes/';

  function isMobile() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
      || (navigator.maxTouchPoints && navigator.maxTouchPoints > 0 && window.innerWidth < 1024);
  }

  if (isMobile()) {
    ig.setAttribute('href', '#');
    ig.setAttribute('aria-label', 'Abrir perfil de Instagram en el navegador');
    ig.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      window.open(mobileWebUrl, '_blank', 'noopener,noreferrer');
    });
  } else {
    ig.setAttribute('href', webUrl);
    ig.removeAttribute('data-ig-web');
    ig.setAttribute('target', '_blank');
    ig.setAttribute('rel', 'noopener noreferrer');
  }
})();
</script>

</body>
</html>
